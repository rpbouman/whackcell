function normalizeSpace(a){return a.replace(/\s\s+/g," ")}function clearBrowserSelection(){win.getSelection?win.getSelection().removeAllRanges():doc.selection&&doc.selection.clear()}function isUnd(a){return typeof a=="undefined"}function isStr(a){return typeof a=="string"}function isObj(a){return typeof a=="object"&&a!==null}function isFunc(a){return typeof a=="function"}function isArr(a){return a.constructor===Array}function isNum(a){return typeof a=="number"}function isInt(a){return isNum(a)&&a===parseInt(a,10)}function isEl(a){return isObj(a)&&a.nodeType===1}function forPinO(a,b,c){isUnd(c)&&(c=null);for(var d in a)if(a.hasOwnProperty(d)&&b.call(c,d,a[d])===!1)return!1;return!0}function forIinA(a,b,c){var d,e=a.length;isUnd(c)&&(c=null);for(d=0;d<e;d++)if(b.call(c,d,a[d])===!1)return!1;return!0}function del(a){var b,c,d=arguments.length;if(d===1)for(c in a)a.hasOwnProperty(c)&&delete a[c];else for(b=1;b<d;b++)a.hasOwnProperty(c=arguments[b])&&delete a[c]}function position(a,b){var c=0,d=0;a=el(a);do c+=a.offsetLeft,d+=a.offsetTop;while(a=a.offsetParent);if(b){var e=position(b);c-=e.left,d-=e.top}return{left:c,top:d}}function el(a){var b;return isStr(a)?b=doc.getElementById(a):isEl(a)&&(b=a),b}function tag(a,b){return isUnd(b)?b=doc:b=el(b),b.getElementsByTagName(a).item(0)}function txt(a){var b;return isUnd(a.innerText)?isUnd(a.textContent)?isUnd(a.nodeTypedValue)?a.normalize?b=function(a){return a.normalize(),a.firstChild?a.firstChild.data:null}:b=function(a){var b=[],c,d=a.childNodes,e,f=d.length;for(e=0;e<f;e+=1)c=d.item(e),c.data!==null&&b.push(c.data);return b.length?b.join(""):null}:b=function(a){return a.nodeTypedValue}:b=function(a){return a.textContent}:b=function(a){return a.innerText},txt=b,b(a)}function escXML(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function hasClass(a,b){return(new RegExp("\\b"+b+"\\b","g")).test(el(a).className)}function getClasses(a){var a=el(a),b=a.className.split(" "),c={};return forIinA(b,function(a,b){b!==""&&(c[b]=b)}),c}function addOrRemoveClasses(a,b,c){if(isArr(a))forIinA(a,function(a,d){addOrRemoveClasses(d,b,c)});else{a=el(a);var d="",e,f=getClasses(a);isStr(b)&&(b=b.split(" "));if(isArr(b)){var g={};forIinA(b,function(a,b){g[b]=b}),b=g}merge(f,b,c),forPinO(f,function(a,b){d+=a+" "}),a.className=d}}function addClasses(a,b){addOrRemoveClasses(a,b)}function addClass(a,b){addOrRemoveClasses(a,b)}function removeClasses(a,b){addOrRemoveClasses(a,b,merge.DELETE)}function removeClass(a,b){removeClasses(a,b)}function replaceClass(a,b,c){a.className=a.className.replace(new RegExp("\\b"+b+"\\b","g"),c)}function sAtts(a,b){a=el(a);var c,d;for(c in b){d=b[c];if(isArr(d))d=d.join(" ");else if(isObj(d))if(c==="style"){var e,f="";for(e in d)f+=e+": "+d[e]+";";d=f}else d=d.toString();a.setAttribute(c,d)}}function sAtt(a,b,c){el(a).setAttribute(b,c)}function gAtt(a,b){return el(a).getAttribute(b)}function rAtt(a,b){el(a).removeAttribute(b)}function hAtt(a,b){return el(a).hasAttribute(b)}function cAtts(a,b){var c,d,e,f,g;d=b.attributes,f=d.length;for(c=0;c<f;c++)g=d[c].nodeName,hAtt(a,g)||rAtt(b,g);d=a.attributes,f=d.length;for(c=0;c<f;c++)e=d[c],g=e.nodeName,sAtt(b,g,e.value)}function chs(a,b){var c;a=el(a),isArr(b)||(b=[b]);for(var d=0,e=b.length,f;d<e;d++)f=b[d],isStr(f)&&(f=doc.createTextNode(f)),a.appendChild(f)}function crEl(a,b,c,d){var e=doc.createElement(a);return b&&sAtts(e,b),c&&chs(e,c),d&&chs(d,e),e}function merge(a,b,c){var d,e;return(c=parseInt(c,10))||(c=merge.MERGE),isObj(a)||(a={}),forPinO(b,function(b,d){if(d===null&&c&merge.DELETE_IF_NULL||c&merge.DELETE)delete a[b];else if(isUnd(a[b])||c&merge.OVERWRITE)a[b]=d}),a}function numGroups(a){return a instanceof RegExp&&(a=a.source),a=a.replace(/\\\(/g,""),a.length-a.replace(/\(/g,"").length}function listen(a,b,c,d){d||(d=win),a.addEventListener?a.addEventListener(b,function(a){c.call(d,Event.get(a))},!0):a.attachEvent&&a.attachEvent("on"+b,function(){c.call(d,Event.get(win.event))})}var doc=document,body=doc.body,head=doc.getElementsByTagName("HEAD").item(0),win=window;merge.MERGE=0,merge.OVERWRITE=1,merge.DELETE_IF_NULL=2,merge.DELETE=4;var Event;(Event=function(a){return a||(a=win.event),this.browserEvent=a,this}).prototype={getTarget:function(){var a=this.browserEvent;return a.target?target=a.target:a.srcElement?target=a.srcElement:target=null,target},getButton:function(){if(doc.addEventListener)return this.browserEvent.button;if(doc.attachEvent)switch(this.browserEvent.button){case 1:return 0;case 2:return 2;case 4:return 1}return null},getKeyCode:function(){return this.browserEvent.keyCode},getShiftKey:function(){return this.browserEvent.shiftKey},getCtrlKey:function(){return this.browserEvent.ctrlKey},getXY:function(){return{x:this.browserEvent.clientX,y:this.browserEvent.clientY}},preventDefault:function(){this.browserEvent.preventDefault()},save:function(){var a=Event.prototype,b=new Event.Saved,c;for(c in a)c.indexOf("get")===0&&isFunc(a[c])&&(b[c.substr(3,1).toLowerCase()+c.substr(4)]=this[c]());return b}},(Event.Saved=function(){}).prototype={destroy:function(){for(var a in this)this.hasOwnProperty(a)&&delete this.p}};for(property in Event.prototype)property.indexOf("get")===0&&isFunc(Event.prototype[property])&&(Event.Saved.prototype[property]=new Function("return this."+property.substr(3,1).toLowerCase()+property.substr(4)+";"));var GlobalEvent=new Event(null);Event.get=function(a){return a||(a=win.event),GlobalEvent.browserEvent=a,GlobalEvent};var Observable;(Observable=function(){}).prototype={listen:function(a,b,c,d){var e,f,c;(e=this.listeners)||(e=this.listeners={}),(f=e[a])||(f=e[a]=[]),c=c?c:win,f.push({method:b,scope:c,context:d?d:c})},fireEvent:function(a,b,c){var d,e,f,g,h,i;if(!(d=this.listeners))return;if(!(e=d[a]))return;for(f=0,g=e.length;f<g;f++){h=e[f];if(!isUnd(c)&&c!==h.context)continue;if(h.method.call(h.scope,this,a,b)===!1)return!1}return!0}};var DDHandler;(DDHandler=function(a){a=merge(a,{node:doc.body});var b=this;b.listeners=[],b.endDragListeners=null,b.whileDragListeners=null,b.node=node=el(a.node),b.mousedown=!1,b.initdrag=!1,a.dragProxy!==!1&&(b.dragProxy=el(a.dragProxy),b.dragProxy||(b.dragProxy=crEl("DIV",{id:isStr(a.dragProxy)?a.dragProxy:""},null,node))),a.dropProxy!==!1&&(b.dropProxy=el(a.dropProxy),b.dropProxy||(b.dropProxy=crEl("DIV",{id:isStr(a.dropProxy)?a.dropProxy:""},null,node))),b.startDragEvent=null,listen(this.node,"mousedown",function(a){b.event=a,a.getButton()===0&&b.handleMouseDown(a)},this),listen(this.node,"mouseup",function(a){b.event=a,a.getButton()===0&&b.handleMouseUp(a)},this),listen(this.node,"mousemove",function(a){b.event=a,b.handleMouseMove(a)},this)}).prototype={listen:function(a){a.scope||(a.scope=win),this.listeners.push(a)},handleMouseDown:function(a){var b=this;b.mousedown=!0,b.initdrag||(b.initdrag=!0,b.startDrag(a))},handleMouseUp:function(a){var b=this;b.mousedown&&(b.initdrag&&(b.initdrag=!1,b.endDrag(a)),b.mousedown=!1)},handleMouseMove:function(a){var b=this;b.mousedown&&(b.initdrag?b.whileDrag(a):(b.initdrag=!0,b.startDrag(a)))},startDrag:function(a){var b=this;b.endDragListeners=[],b.whileDragListeners=[],b.startDragEvent=a.save(),forIinA(b.listeners,function(c,d){d.startDrag.call(d.scope,a,b)&&(isFunc(d.endDrag)&&b.endDragListeners.push(d),isFunc(d.whileDrag)&&b.whileDragListeners.push(d))})},endDrag:function(a){var b=this;b.startDragEvent&&(forIinA(b.endDragListeners,function(c,d){d.endDrag.call(d.scope,a,b)}),b.startDragEvent.destroy(),b.startDragEvent=null),b.endDragListeners=null,b.whileDragListeners=null},whileDrag:function(a){var b=this;b.startDragEvent&&(clearBrowserSelection(),forIinA(b.whileDragListeners,function(c,d){d.whileDrag.call(d.scope,a,b)}))}};var KBHandler;(KBHandler=function(a){this.config=a}).prototype=merge({render:function(){var a=this,b=a.config,c=el(b.container),d=crEl("TEXTAREA",{style:{position:"absolute",height:"0px",width:"0px",top:"0px",left:"0px","z-index":-1}},null,c);a.textArea=d,listen(d,"keydown",function(b){a.fireEvent("keydown",b)}),listen(d,"keyup",function(b){a.fireEvent("keyup",b)}),listen(d,"keypress",function(b){a.fireEvent("keypress",b)})},focus:function(){if(this.fireEvent("focus")!==!1)this.textArea.focus();else return!1}},Observable.prototype),define("js/utils.js",function(){}),define("js/CascadingStyleSheet.js",["require","js/utils.js"],function(a){a("js/utils.js");var b;return(b=function(a){this.config=a=merge(a,{enabled:!0,rules:{}}),a.id&&(this.style=el(a.id),this.style===null)}).prototype={render:function(){var a=this,b=a.config;a.style=crEl("STYLE",{type:"text/css",id:b.id},null,head),b.rules&&a.addRules(b.rules)},enable:function(a){this.config.enabled=a,this.style&&(this.style.disabled=!a)},getRule:function(a){var b=this.getRuleSet(),c=null;return a=a.toUpperCase(),forIinA(b,function(b,d){if(d.selectorText.toUpperCase()===a)return c=d,!1}),c},getStyle:function(a){var b;return(b=this.getRule(a))?b.style:null},unApplyStyle:function(a,b){var c=this.getStyle(a);if(c===null)return;merge(c,b,merge.DELETE)},applyStyle:function(a,b,c){var d=this.getRule(a);if(d===null){c!==!1&&this.addRule(a,b);return}merge(d.style,b,merge.OVERWRITE)},getCssText:function(a){var b,c,d="";for(b in a)if(a.hasOwnProperty(b)){c=a[b];if(c===null)continue;d!==""&&(d+=";"),d+="\n"+b+": "+c}return d},addRule:function(a,b){var c,d,e,f,g;arguments.length===1&&(b=a.properties,a=a.selector),isStr(b)?d=b:isObj(b)&&(d=this.getCssText(b));if(c=this.style.styleSheet)g=c.addRule.call(c,a,d);else if(c=this.style.sheet)c.addRule?g=c.addRule.call(c,a,d):c.insertRule&&(g=c.insertRule.call(c,a+"{"+d+"}",c.cssRules.length));else throw"No stylesheet"},addRules:function(a){if(isObj(a))if(isArr(a)){var b,c=a.length,d;for(b=0;b<c;b++)d=a[b],this.addRule(d.selector,d.styles)}else for(selector in a)a.hasOwnProperty(selector)&&this.addRule(selector,a[selector]);return!0},getRuleSet:function(){if(!this.style)return null;var a=this.style.sheet||this.style.styleSheet;return a.rules||a.cssRules},getRules:function(a){var b={};return isStr(a)?a=[a]:isArr(a)||!isObj(a),b}},b}),define("js/whackcell/DataGrid.js",["require","js/utils.js","js/CascadingStyleSheet.js"],function(a){a("js/utils.js");var b=a("js/CascadingStyleSheet.js"),c;return(c=function(a){var b=this;b.config=a=merge(a,{firstDisplayCol:1,firstDisplayRow:1}),b.numRows=Math.max(a.lastRow,a.numDisplayRows),b.numCols=Math.max(a.lastCol,a.numDisplayCols),b.firstDisplayCol=a.firstDisplayCol?a.firstDisplayCol:1,b.firstDisplayRow=a.firstDisplayRow?a.firstDisplayRow:1,b.selection=[],isObj(a.kbHandler)&&(this.kbHandler=a.kbHandler),isObj(a.ddHandler)&&(this.ddHandler=a.ddHandler),b.render()}).prototype=merge({render:function(){var a=this,b=a.config,d="",e="",f="",g="",h=b.firstDisplayCol,i=b.firstDisplayRow,j=h+a.config.numDisplayCols-1,k=i+a.config.numDisplayRows-1,l=this.container=el(b.div),m=l.id,n="\n#"+m+" > TABLE > * > TR",o="",p={},q,r,s;addClass(l,"wxl_datagrid"),o=n+" > .";for(r=0,s=a.numCols;r<=s;r++)q="c"+r,f+='<th class="'+q+'" scope="col" style="width:54px">',f+='<div class="wxl_header wxl_column_header" >'+(r?"<span>"+c.getColumnHeaderName(r-1)+"</span>"+'<div class="wxl_resize wxl_resize_horizontal"></div>':"")+"</div>",f+="</th>",r&&(e+='<td class="'+q+'" ></td>',r>j&&(p[o+q]={display:"none"}));tagName="tr",e+="</tr>",n+=".";for(r=1,s=a.numRows;r<=s;r++)q="r"+r,g+='<tr class="'+q+'" style="height: 16px;">'+'<th class="th" scope="row" >'+'<div class="wxl_header wxl_row_header">'+"<span>"+r+"</span>"+'<div class="wxl_resize wxl_resize_vertical"></div>'+"</div>"+"</th>"+e,r>k&&(p[n+q]={display:"none"});l.innerHTML='<table cellspacing="0" cellpadding="0" class="wxl_datagrid" id="wxl_'+m+'">'+'<thead><tr class="r0">'+f+"</tr></thead>"+"<tbody>"+g+"</tbody>"+"</table>",a.table=tag("table",l),a.initStyleSheet(p),listen(a.table,"click",this.clickHandler,a);return},initStyleSheet:function(a){var c=this;c.stylesheet=new b({id:c.config.id+"-style"}),c.stylesheet.render(),c.stylesheet.addRules(a||{})},getKBHandler:function(){var a=this,b=this.kbHandler;return b||(b=this.kbHandler=new KBHandler({container:a.container}),b.render()),b},getDDHandler:function(){var a=this,b=this.ddHandler;return b||(b=this.ddHandler=new DDHandler({node:this.container})),b},getColumnHeader:function(a){return a=c.getColumnIndex(a),this.table.rows.item(0).cells.item(a)},getRowHeader:function(a){return this.table.rows.item(a).cells.item(0)},createRange:function(a,b,c,d){return new Range({dataGrid:this,start:{row:a,col:b},end:{row:c,col:d}})},clearSelection:function(){var a,b=/ wxl_selected/g;while(this.selection.length)a=this.selection.shift(),a.each(function(a){removeClass(a,"wxl_selected")})},addToSelection:function(a){var b=" wxl_selected";a.each(function(a){var c=a.className;c.indexOf(b)===-1&&(a.className=c+b)}),this.selection.push(a)},selectRow:function(a){this.addToSelection(this.createRange(a,1,a,this.numCols))},selectColumn:function(a){this.addToSelection(this.createRange(1,a,this.numRows,a))},selectCell:function(a){this.addToSelection(this.createRange(a.parentNode.rowIndex,a.cellIndex,a.parentNode.rowIndex,a.cellIndex))},focus:function(){this.table.focus()},getActiveCell:function(){return this.activeCell},setActiveCell:function(a){var b;if(b=this.activeCell){if(this.fireEvent("beforecelldeactivated",b)===!1)return;removeClass([b,this.getColumnHeader(b.cellIndex),this.getRowHeader(b.parentNode.rowIndex)],"wxl_active"),this.fireEvent("celldeactivated",b)}this.activeCell=a,a&&(addClass([a,this.getColumnHeader(a.cellIndex),this.getRowHeader(a.parentNode.rowIndex)],"wxl_active"),this.scrollIntoView(a),this.fireEvent("cellactivated",a))},scrollIntoView:function(a){var b=this.config,c=b.numDisplayCols,d=b.firstDisplayCol,e=d+c-1,f=b.numDisplayRows,g=b.firstDisplayRow,h=g+f-1,i=a.cellIndex,j=a.parentNode.rowIndex,k,l,m,n,o=this.stylesheet,p=this.container.id,q="#"+p+" > TABLE > * > TR";i<d?(b.firstDisplayCol=k=i,l=Math.min(k+c,d),m=Math.max(k+c,d),n=e+1):i>e?(l=i+1,b.firstDisplayCol=k=l-c,m=d,n=Math.min(m+c,k)):k=l=0;for(;k<l;k++)o.applyStyle(q+" > .c"+k,{display:""});for(;m<n;m++)o.applyStyle(q+" > .c"+m,{display:"none"});j<g?(b.firstDisplayRow=k=j,l=Math.min(k+f,g),m=Math.max(k+f,g),n=h+1):j>h?(l=j+1,b.firstDisplayRow=k=l-f,m=g,n=Math.min(m+f,k)):k=l=0;for(;k<l;k++)o.applyStyle(q+".r"+k,{display:""});for(;m<n;m++)o.applyStyle(q+".r"+m,{display:"none"})},getRows:function(){return this.table.rows},getCellContent:function(a){return this.getCellText()},setCellContent:function(a,b){this.setCellText(a,b)},getCellText:function(a){return txt(a)},setCellText:function(a,b){a.innerHTML=escXML(b)},clearCell:function(a){rAtt(a,"data-content"),a.innerHTML=""},copyCell:function(a,b){cAtts(a,b),b.innerHTML=a.innerHTML},clickHandler:function(a){var b=a.getTarget(),c=b.className,d;a:switch(b.tagName){case"SPAN":d=b.parentNode;switch(d.tagName){case"DIV":case"TD":b=d,c=b.className;break;default:break a};case"DIV":switch(c){case"wxl_header wxl_column_header":break a;case"wxl_header wxl_row_header":break a;default:d=b.parentNode;if(d.tagName==="TD")b=d;else break a};case"TD":if(this.fireEvent("click",b)===!1)return;this.setActiveCell(b)}if(this.getKBHandler().focus()===!1)return this.cellEditor&&this.cellEditor.focus(),!1},setCellEditor:function(a){a.initDataGrid(this)},setCellNavigator:function(){}},Observable.prototype),c.getColumnHeaderName=function(a){var b,c="";do b=a%26,a=(a-b)/26,c=String.fromCharCode(b+65)+c;while(a-->0);return c},c.getColumnIndex=function(a){if(isInt(a))d=a;else if(/^[A-Z]+$/i.test(a)){a=a.toUpperCase();var b,c=a.length-1,d=0;for(b=c;b>=0;b--)d+=a.charCodeAt(b)-64}else/\d+/&&(d=parseInt(a,10));return d},c.getCellName=function(a){return c.getColumnHeaderName(a.cellIndex-1)+a.parentNode.rowIndex},c}),define("js/whackcell/Range.js",["require","js/utils.js"],function(a){a("js/utils.js");var b;return(b=function(a){this.config=a}).prototype={each:function(a,b){var c=this.config,d=c.start,e=c.end,f=d.row,g=e.row,h,i=e.col,j=c.dataGrid.getRows(),k,l;b||(b=win);for(;f<=g;f++){k=j.item(f),h=d.col;for(;h<=i;h++)l=k.cells.item(h),a.call(b,l)}},allRows:function(){return this.start.row===1&&this.end.row===this.config.dataGrid.numRows},allCols:function(){return this.start.col===1&&this.end.col===this.config.dataGrid.numCols}},b}),define("js/whackcell/Movable.js",["require"],function(a){var b;(b=function(a){this.config=merge(a,{rows:!0,columns:!0}),this.init()}).prototype={init:function(){var a=this.config,b=a.dataGrid;a.rows!==!1&&(b.moveRow=this.moveRow),a.columns!==!1&&(b.moveColumn=this.moveColumn),a.ddsupport&&new c(merge(a.ddsupport,a))},moveRow:function(a,b){if(b===a)return;var c=this.table,d=c.rows,e=d.item(a),f,g=e.cells,h=g.length,i,j,k,l=this.activeCell;l&&l.parentNode.rowIndex===a&&(l=l.cellIndex,this.setActiveCell(null)),j=c.insertRow(b),j.className="r"+b,j.appendChild(crEl("TH",{"class":"th",scope:"row"},tag("DIV",g.item(0)))),tag("SPAN",j.cells.item(0)).innerHTML=b;for(i=1;i<h;i++)f=g.item(i),k=j.insertCell(i),this.copyCell(f,k);this.table.deleteRow(e.rowIndex);for(i=a;i!==b;i+=a<b?1:-1)row=d.item(i),row.className="r"+i,tag("SPAN",row.cells.item(0)).innerHTML=i;l&&this.setActiveCell(j.cells.item(l))},moveColumn:function(a,b){if(b===a)return;var c=this.table,d=c.rows,e,f=d.length,g,h,i,j=this.activeCell;j&&j.cellIndex===a?(j=j.parentNode.rowIndex,this.setActiveCell(null)):j=null;for(var e=1;e<f;e++)g=d.item(e),h=g.cells.item(a),i=g.insertCell(b),this.copyCell(h,i),g.deleteCell(h.cellIndex);j&&this.setActiveCell(d.item(j).cells.item(b))}};var c;return(c=function(a){this.config=a,this.init()}).prototype={init:function(){var a=this.config,b=a.dataGrid,c=b.container,d=b.table;b.getDDHandler().listen({scope:this,startDrag:function(b,c){var e=b.getTarget();if(e.tagName==="DIV"&&hasClass(e,"wxl_header")){var f=c.dragProxy,g=f.style,h=c.dropProxy,i=h.style,j=e.parentNode,k=position(j),l=position(d),m,n=c.startDragEvent,o,p;k.x=k.left-l.left,k.y=k.top-l.top,f.className="";if(hasClass(e,"wxl_row_header")){if(a.rows===!1)return!1;o=k.x+j.clientWidth+"px",p=d.clientWidth-j.clientWidth+"px",g.width=p,g.left=o,g.height=j.clientHeight+"px",g.top=(n.top=k.y)+"px",m="wxl_row_mover",i.width=p,i.left=o,h.className="wxl_row_drop",i.height="3px"}else if(hasClass(e,"wxl_column_header")){if(a.columns===!1)return!1;o=k.y+j.clientHeight+"px",p=d.clientHeight-j.clientHeight+"px",g.height=p,g.top=o,g.width=j.clientWidth+"px",g.left=(n.left=k.x)+"px",m="wxl_column_mover",i.height=p,i.top=o,h.className="wxl_column_drop",i.width="3px"}return n.cls=m,addClasses(f,["wxl_mover",m]),!0}return!1},whileDrag:function(a,b){var c=b.dragProxy,e=c.style,f=b.dropProxy,g=f.style,h,i,j=b.startDragEvent,k=j.target,l=j.getXY(),m=a.getXY(),n=a.getTarget(),o=n.parentNode;switch(j.cls){case"wxl_row_mover":e.top=j.top+(m.y-l.y)+"px",n.tagName==="SPAN"&&(n=n.parentNode);if(n.tagName!=="DIV")break;hasClass(n,"wxl_resize")&&(n=n.parentNode);if(!hasClass(n,"wxl_row_header"))break;i=position(o),h=position(d),g.display="",g.top=i.top-h.top+(m.y-i.top<o.clientHeight/2?0:o.clientHeight)+"px";return;case"wxl_column_mover":e.left=j.left+(m.x-l.x)+"px",n.tagName==="SPAN"&&(n=n.parentNode);if(n.tagName!=="DIV")break;hasClass(n,"wxl_resize")&&(n=n.parentNode);if(!hasClass(n,"wxl_column_header"))break;i=position(o),h=position(d),g.display="",g.left=i.left-h.left+(m.x-i.left<o.clientWidth/2?0:o.clientWidth)+"px";return}g.display="none"},endDrag:function(a,c){var d=c.dragProxy,e=d.style,f=c.dropProxy,g=f.style,h=c.startDragEvent,i=h.target,j,k=a.getTarget(),l,m,n=a.getXY();switch(h.cls){case"wxl_row_mover":k.tagName==="SPAN"&&(k=k.parentNode);if(k.tagName!=="DIV")break;hasClass(k,"wxl_resize")&&(k=k.parentNode);if(!hasClass(k,"wxl_row_header"))break;l=k.parentNode,sourceIndex=i.parentNode.parentNode.rowIndex,m=l.parentNode.rowIndex,j=position(l),n.y-j.top>=l.clientHeight/2&&m++,b.moveRow(sourceIndex,m);break;case"wxl_column_mover":k.tagName==="SPAN"&&(k=k.parentNode);if(k.tagName!=="DIV")break;hasClass(k,"wxl_resize")&&(k=k.parentNode);if(!hasClass(k,"wxl_column_header"))break;l=k.parentNode,sourceIndex=i.parentNode.cellIndex,m=l.cellIndex,j=position(l),n.x-j.left>=l.clientWidth/2&&m++,b.moveColumn(sourceIndex,m)}d.className="",g.display="none",b.getKBHandler().focus()}})}},b}),define("js/whackcell/Resizable.js",["require","js/utils.js"],function(a){a("js/utils.js");var b;(b=function(a){this.config=merge(a,{rows:!0,columns:!0}),this.init()}).prototype={init:function(){var a=this.config,b=a.dataGrid;a.columns!==!1&&(b.setColumnWidth=this.setColumnWidth,b.getColumnWidth=this.getColumnWidth),a.rows!==!1&&(b.setRowHeight=this.setRowHeight,b.getRowHeight=this.getRowHeight),a.ddsupport&&new c(merge(a.ddsupport,a))},setColumnWidth:function(a,b){var c=this.getColumnHeader(a),d=tag("DIV",c),e=tag("DIV",d);e&&b<e.clientWidth&&(b=e.clientWidth),c.style.width=d.style.width=b+"px"},getColumnWidth:function(a){return tag("DIV",this.getColumnHeader(a)).clientWidth},setRowHeight:function(a,b){var c=this.getRowHeader(a),d=tag("DIV",c),e=tag("DIV",d);e&&width<e.clientHeight&&(b=e.clientHeight),c.style.height=d.style.height=b+"px"},getRowHeight:function(a){return tag("DIV",this.getRowHeader(a)).clientHeight}};var c;return(c=function(a){this.config=a,this.init()}).prototype={init:function(){var a=this.config,b=a.dataGrid,c=b.container,d=b.table;b.getDDHandler().listen({scope:this,startDrag:function(b,c){var e=b.getTarget();if(e.tagName==="DIV"&&hasClass(e,"wxl_resize")){var f=b.getXY(),g=position(d),h,i=c.startDragEvent,j=c.dragProxy,k=j.style;j.className="";if(hasClass(e,"wxl_resize_vertical")){if(a.rows===!1)return!1;f.y+=e.clientHeight,k.width=d.clientWidth+"px",k.height="1px",k.top=(i.top=f.y-g.top)+"px",k.left="0px",h="wxl_resizer_vertical"}else if(hasClass(e,"wxl_resize_horizontal")){if(a.columns===!1)return!1;f.x+=e.clientWidth,k.width="1px",k.height=d.clientHeight+"px",k.left=(i.left=f.x-g.left)+"px",k.top="0px",h="wxl_resizer_horizontal"}return i.cls=h,addClasses(j,["wxl_resizer",h]),!0}return!1},whileDrag:function(a,b){var c=b.dragProxy,d=b.startDragEvent,e=d.getXY(),f=a.getXY();switch(d.cls){case"wxl_resizer_vertical":c.style.top=d.top+(f.y-e.y)+"px";break;case"wxl_resizer_horizontal":c.style.left=d.left+(f.x-e.x)+"px"}},endDrag:function(a,c){var d=c.dragProxy,e=c.startDragEvent,f=e.target,g=f.parentNode,h=e.getXY(),i=a.getXY(),j,k,l;d.className="",hasClass(f,"wxl_resize_vertical")?(j=g.clientHeight,k=j+(i.y-h.y),l=f.clientHeight,g.parentNode.parentNode.style.height=g.parentNode.style.height=g.style.height=(k>=l?k:l)+"px"):hasClass(f,"wxl_resize_horizontal")&&(j=g.clientWidth,k=j+(i.x-h.x),l=f.clientWidth,g.style.width=(k>=l?k:l)+"px",g.parentNode.style.width=(k>=l?k:l)+4+"px"),b.getKBHandler().focus()}})}},b}),define("js/whackcell/KeyboardNavigable.js",["require","js/utils.js"],function(a){a("js/utils.js");var b;return(b=function(a){this.config=a,this.init()}).prototype={init:function(){var a=this,b=a.config.dataGrid;b.moveToCell=this.moveToCell,b.getKBHandler().listen("keydown",b.moveToCell,b)},moveToCell:function(a,b,c){var d=this,e=d.activeCell;if(!e)return;var f=e.cellIndex,g=e.parentNode,h=g.rowIndex,i=g.parentNode.parentNode.rows;switch(c.getKeyCode()){case 9:c.getShiftKey()?--f===0&&(f=g.cells.length-1,h--):++f===g.cells.length&&(f=1,h++);break;case 13:h+=c.getShiftKey()?-1:1;break;case 33:h=h-(h>d.config.numDisplayRows?d.config.numDisplayRows:h)+1;break;case 34:h=h+(d.numRows-h>d.config.numDisplayRows?d.config.numDisplayRows:d.numRows-h)-1;break;case 35:f=g.cells.length-1;break;case 36:f=1;break;case 37:f--;break;case 39:f++;break;case 38:h--;break;case 40:h++;break;default:return}c.preventDefault();if(!f||!h)return;g=i.item(h);if(!g)return;e=g.cells.item(f);if(!e)return;return d.setActiveCell(e),!1}},b}),define("js/whackcell/CellEditor.js",["require","js/utils.js","js/whackcell/DataGrid.js"],function(a){a("js/utils.js");var b=a("js/whackcell/DataGrid.js"),c;return(c=function(a){this.config=a=merge(a,{}),this.dataGrid=null,this.cell=null,this.render()}).prototype={initDataGrid:function(a){a.cellEditor=this,a.listen("cellactivated",this.cellActivated,this),a.listen("click",this.cellClicked,this);var b=a.getKBHandler();b.listen("keydown",this.dataGridKeyDownHandler,this)},render:function(){var a=this,b=el(a.config.textarea);a.editing=!1,sAtts(b,{"class":"wxl_celleditor",autocomplete:"off"}),listen(b,"keydown",a.keydownHandler,a),listen(b,"keyup",a.keyupHandler,a),listen(b,"focus",a.focusHandler,a),listen(b,"click",a.clickHandler,a),a.textarea=b},setEnabled:function(a){this.textarea.disabled=!a},cellClicked:function(a,c,d){if(!this.editing)return;var e=this.textarea,f=e.value;if(f.charAt(0)!=="=")return this.stopEditing();var g=e.selectionStart,h=f.substr(0,g),i=f.substr(e.selectionEnd),j=b.getCellName(d);return e.value=h+j+i,e.selectionStart=e.selectionEnd=g+j.length,this.syncCell(),this.focus(),!1},cellActivated:function(a,b,c){var d=this.textarea;this.isEditing()&&c!==this.cell&&this.stopEditing(),this.dataGrid=a,this.cell=c,d.value=a.getCellContent(c)},isEditing:function(){return this.editing},startEditing:function(a,b,c){var d=this;d.dataGrid=a,d.cell=c,this.oldValue=a.getCellContent(c),d.editing=!0,d.syncCell(),addClass(this.textarea,"wxl_active"),addClass(c,"wxl_editing"),d.textarea.select(),b!=="focus"&&d.focus()},stopEditing:function(){if(!this.editing)return;var a=this.dataGrid,b=this.cell,c=this.textarea;if(!b)return!0;try{a.setCellContent(b,c.value),removeClass(c,"wxl_active"),this.editing=!1,removeClass(b,"wxl_editing"),c.blur(),a.focus(),this.cell=null,this.dataGrid=null,stopEditing=!0}catch(d){alert(d.message||d),stopEditing=!1}return stopEditing},dataGridKeyDownHandler:function(a,b,c){var d=c.getKeyCode();switch(d){case 9:case 13:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 8:case 16:case 17:case 18:case 27:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:case 123:return}var e=this.dataGrid,f=this.cell;if(f)return d===46?(e.clearCell(f),this.textarea.value=""):this.startEditing(e,c,f),!1},keydownHandler:function(a){var b=a.getKeyCode();switch(b){case 27:this.textarea.value=this.oldValue;case 9:case 13:var c=this.dataGrid;if(this.isEditing()){a.preventDefault();if(this.stopEditing()){var d=c.getKBHandler();d.focus(),d.fireEvent("keydown",a)}}break;case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:}return!1},keyupHandler:function(a){var b=a.getKeyCode();switch(b){case 9:case 13:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:a.preventDefault();break;default:this.syncCell()}return!1},syncCell:function(){var a=this.dataGrid,b=a.getActiveCell();a.setCellText(b,""),a.setCellText(b,this.textarea.value)},focus:function(){this.textarea.focus()},focusHandler:function(a){var b=this.dataGrid,c;!b||!(c=b.getActiveCell())},clickHandler:function(a){this.focus()}},c}),define("js/whackcell/CellNavigator.js",["require","js/utils.js","js/whackcell/DataGrid.js"],function(a){a("js/utils.js");var b=a("js/whackcell/DataGrid.js"),c;return(c=function(a){this.config=a=merge(a,{}),this.init()}).prototype={init:function(){var a=this.config.dataGrid;a.listen("cellactivated",this.cellActivated,this),this.render()},render:function(){var a=this,b=el(a.config.input);sAtts(b,{size:4,"class":"wxl_cellnavigator",autocomplete:"off"}),listen(b,"change",this.changeHandler,this),listen(b,"focus",this.focusHandler,this),this.input=b},cellActivated:function(a,c,d){this.input.value=b.getCellName(d)},changeHandler:function(){},focusHandler:function(){this.input.select()}},c}),define("js/whackcell/CellValues.js",["require","js/utils.js"],function(a){a("js/utils.js");var b;return(b=function(a){this.config=a,this.init()}).prototype={clsPrefix:"wxl_datatype_",init:function(){var a=this.config,c=a.dataGrid,d,e=0,f={},g=a.formulaSupport,h;g&&(h=g.createCellValueHelper(),f[h.name]=h,g.dataGrid=c),c.valueHelper=this,c.setCellContent=this.setCellContent,c.getCellContent=this.getCellContent,c.setCellValue=this.setCellValue,c.getCellValue=this.getCellValue,d="",this.patterns=merge(f,a.patterns||b.patterns),forPinO(this.patterns,function(a,b){var c;b.name=a,d.length&&(d+="|"),c=b.regexp.source,b.startGroup=++e,e+=numGroups(c),b.endGroup=e+1,d+="("+c+")"}),this.regexp=new RegExp("^"+d+"$","i")},setCellContent:function(a,b){var c=this.valueHelper,d=c.config.formulaSupport,e=c.parse(b,a),f=e.value,g=e.type,h,i=c.clsPrefix,j=a.className=normalizeSpace(a.className.replace(new RegExp("\\b"+i+"\\w+\\b","g"),""));if(e.error)throw a.className=normalizeSpace(j+" "+i+"error"),e.error;sAtt(a,"data-content",b),this.setCellValue(a,f,g),d&&d.updateDependencies(a)},setCellValue:function(a,b,c){var d=a.className,e,f=this.valueHelper,g=f.clsPrefix;a.value=b;if(c){e=c.name,d=d+" "+g+e;if(e==="formula"){e=typeof b;switch(e){case"string":case"number":break;case"object":b.constructor==Date?typename="date":e=null;break;default:e=null}e&&(d+=" "+g+e)}a.className=normalizeSpace(d),b=c.toText(b)}this.setCellText(a,b)},getCellValue:function(a){var c=a.value;return isUnd(c)&&(c=b.prototype.getCellContent(a)),c},getCellContent:function(a){var b=gAtt(a,"data-content");return b===null?txt(a):b},parse:function(a,b){var c,d=this.regexp.exec(a);return d?forPinO(this.patterns,function(e,f){if(d[f.startGroup]!==a)return;return c=f.parser(d.slice(f.startGroup,f.endGroup),b),c.type=f,!1})?{value:a}:c:{value:a}}},b.patterns={string:{regexp:/'(.+)/,parser:function(a){return{value:a[0].substr(1)}},toText:function(a){return a}},date:{regexp:/(\d{2,4}[\/\.\-]\d{1,2}([\/\.\-]\d{1,2}(T\d\d:\d\d(:\d\d)?(Z|[+-]\d\d:\d\d))?)?)|(((Mon?|Tue?|Wed?|Thu?|Fri?|Sat?|Sun?),?\s*)?\d{1,2}\s*(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s*\d{1,4}(\s+\d\d:\d\d(:\d\d(\s+(UT|GMT|EST|EDT|CST|CDT|MST|MDT|PST|PDT|Z|A|M|N|Y|([+-]\s*\d{4})))?)?)?)/,parser:function(a){var b=Date.parse(a[0]),c={};return isNaN(b)?c.error="Invalid date":c.value=new Date(b),c},toText:function(a){return a.toString()}},number:{regexp:/[+-]?((((\d+)|(\d{1,3}(,\d{3})+))(\.\d*)?)|(\.\d+))([eE][+-]?\d+)?/,parser:function(a){return{value:Number(a[0].replace(",",""))}},toText:function(a){return String(a)}}},b}),define("js/whackcell/FormulaSupport.js",["require","js/utils.js","js/whackcell/DataGrid.js","js/whackcell/CellValues.js"],function(a){a("js/utils.js");var b=a("js/whackcell/DataGrid.js"),c=a("js/whackcell/CellValues.js"),d;(d=function(a){this.config=a,this.init(),this.formulas={},this.compiledFunctions={}}).prototype={init:function(){this.parser=new e},resolveCell:function(a,b){var c;switch(b.format){case"A1":c=a.item(b.row).cells.item(b.col);break;case"R1C1":c=a.item(row.rowIndex+(b.rowInc?b.rowInc:0)).cells.item(c.cellIndex+(b.colInc?b.colInc:0));break;default:throw"Invalid parameter"}return c},getCellRows:function(a){return a.parentNode.parentNode.parentNode.rows},getDependencies:function(a){var b=gAtt(a,"data-dependent-cells");return b?JSON.parse(b):[]},sortDependencies:function(a){var b=this,c=b.getAllDependencies(a),d=[],e,f,g,h=b.getCellRows(a),i;for(e in c){i=h.item(parseInt(e,10)),f=c[e];for(g in f)d.push(i.cells.item(parseInt(g,10)))}return d.sort(function(a,d){return c=b.getAllDependencies(a),g=d.cellIndex,e=d.parentNode.rowIndex,f=c[e],f?f[g]?-1:1:1}),d},updateDependencies:function(a){var b=this.sortDependencies(a),c,d=b.length,e;for(c=0;c<d;c++)e=b[c],this.dataGrid.setCellValue(e,this.calculate(e),this.valueHelper)},getAllDependencies:function(a){var b=this.getCellRows(a),c=[],d=0,e={},f,g,h,i,j,k,l;do{i=this.getDependencies(a),k=i.length;for(j=0;j<k;j++)l=i[j],f=l.r,(h=e[f])||(h=e[f]={}),g=l.c,h[g]||(h[g]=!0,c.push(b.item(f).cells.item(g)))}while(a=c[d++]);return e},registerCellDependency:function(a,b){var c={message:"Circular reference"};if(a===b)throw c;var d=this.getDependencies(b),e,f,g=d.length,h=a.parentNode.rowIndex,i=a.cellIndex,j,k,l;for(e=0;e<g;e++){f=d[e];if(f.r===h&&f.c===i)return}j=this.getAllDependencies(a),k=j[b.parentNode.rowIndex];if(k&&k[b.cellIndex])throw c;d.push({r:h,c:i}),sAtt(b,"data-dependent-cells",JSON.stringify(d))},calculate:function(a){var b=gAtt(a,"data-formula");if(!b)throw"Not a formula";b=JSON.parse(b);var d,e;if(d=b.params){if(!isArr(d))throw"Invalid parameters";e=d.length}else e=0;var f=b.id;if(isUnd(f))throw"Invalid formula";if(isUnd(b=this.compiledFunctions[f]))throw"Invalid formula";var g,h,i,j=[],k=this.getCellRows(a);for(g=0;g<e;g++){h=d[g];if(!isUnd(h.value)){j[g]=h.value;continue}i=this.resolveCell(k,h.cell),j[g]=c.prototype.getCellValue(i)}return b.func.apply(null,j)},clearFormula:function(a){var b=gAtt(a,"data-formula");if(!b)return;b=JSON.parse(b);var c;if(c=b.params){if(!isArr(c))throw"Invalid parameters";var d,e=c.length,f,g;for(d=0;d<e;d++){f=c[d];if(isUnd(f.cell))continue;g=this.resolveCell(rows,f.cell),this.unRegisterCellDependency(a,g)}}var h=b.id,i=this.compiledFunctions[h],j=i.text;b=this.formulas[j],--b.refCount||(del(this.compiledFunctions,h),del(i),del(this.formulas,j),del(b))},createCellValueHelper:function(){var a=this;return a.valueHelper||(a.valueHelper={regexp:/=(.+)/,name:"formula",parser:function(b,c){var d,e,f,g,h=a.formulas,i=a.compiledFunctions,j=[],k,l,m,n,o=a.getCellRows(c),p;try{d=a.parser.parse(b[1],c),f=a.compile(d,j),k=j.length;if(!(g=h[f])){e=f,g={id:e,refCount:1},h[f]=g;var q=[];for(l=0;l<k;l++)m=j[l],q.push(m.name);q.push("return "+f+";"),i[e]={text:f,func:Function.apply(null,q)}}else e=g.id,g.refCount++;sAtt(c,"data-formula",JSON.stringify({id:e,params:j}));for(l=0;l<k;l++){m=j[l];if(!m.cell)continue;n=a.resolveCell(o,m.cell),a.registerCellDependency(c,n)}p={value:a.calculate(c)}}catch(r){p={error:r.message}}return p},toText:function(a){return String(a)}}),a.valueHelper},compile:function(a,b){var c=this.parser.tokenClasses,d=c[a.c],e,f,g,h;if(e=d.semantics){if(g=a.l)e=e.replace(/_l/g,this.compile(g,b));if(g=a.r)e=e.replace(/_r/g,this.compile(g,b));if(g=a.n)e=e.replace(/_n/g,g);if(g=a.a){var i="";if(isArr(g)){var j=0,k=g.length;for(;j<k;j++)i.length&&(i+=","),i+=this.compile(g[j],b)}else i=this.compile(g,b);e=e.replace(/_a/g,i)}}else{e="";if(d.type!=="operand")throw"Unexpected parse node type (not an operand)";k="_"+b.length,f={name:k},d.name==="cell"?f.cell=a:f.value=a.v,b.push(f),e+=k}return e}};var e;return(e=function(a){this.config=a,this.init()}).prototype={name:"formula",tokenClasses:{whitespace:{patt:/\s+/,type:"separator"},":":{patt:/:/,type:"binary",precedence:90,semantics:"Range(_l,_r)"},"~":{patt:/~/,type:"binary",precedence:90,semantics:"Intersect(_l,_r)"},"!":{patt:/!/,type:"binary",precedence:90,semantics:"Union(_l,_r)"},"%":{patt:/%/,type:"post",precedence:80,semantics:"(_l/100)"},unop:{type:"pre",precedence:80,semantics:"_n_r"},"^":{patt:/\^/,type:"binary",precedence:70,semantics:"_l_n_r"},"[*/]":{patt:/[\*\/]/,type:"binary",precedence:60,semantics:"_l_n_r"},"[+-]":{patt:/[+-]/,type:"binary",precedence:50,semantics:"_l_n_r"},"&":{patt:/&/,type:"binary",precedence:40,semantics:"String(_l)+String(_r)"},relop:{patt:/<=|>=|<>|>|<|=/,type:"binary",precedence:30,semantics:"_l_n_r"},"[,;]":{patt:/[,;]/,type:"binary",precedence:20,semantics:"_l,_r"},"(":{patt:/\(/,type:"left",precedence:10,semantics:"(_a)"},")":{patt:/\)/,type:"right",precedence:10},func:{semantics:"_n(_a)"},num:{patt:/[+-]?((((\d+)|(\d{1,3}(,\d{3})+))(\.\d*)?)|(\.\d+))([eE][+-]?\d+)?/,type:"operand"},str:{patt:/"(([^"]|"")*)"/,type:"operand"},cell:{patt:/(([Rr]((\[([+-]?\d+)\]|\d*)))([Cc](\[([+-]?\d+)\]|(\d*))))|(((\$)?([A-Za-z]+))((\$)?(\d+)))/,type:"operand"},name:{patt:/\w+/,type:"operand"}},init:function(){var a="",b=this.tokenClasses,c,d,e=1,f=this.tokenTypes={};forPinO(b,function(b,c){c.name=b;if(!c.patt)return;a.length&&(a+="|"),d=c.patt.source,e+=1,a+="("+d+")",c.groups=numGroups(d),f[String(e)]=c,e+=c.groups}),this.regexp=new RegExp("("+a+")","g")},setText:function(a){this.text=a,this.regexp.lastIndex=0,this.from=0},nextToken:function(){var a=this.regexp.exec(this.text),b=this.tokenTypes,c,d,e,f;if(a===null)throw"Match Error";for(d in b){d=parseInt(d,10),c=a[d];if(!c)continue;return e=b[d],{type:e.type,c:e.name,groups:f=a.splice(d,e.groups+1),f:this.from,t:this.from+=f[0].length}}},tokenize:function(a){var c=this.tokenClasses,d=c["("],e=c[")"],f,g,h=a.length,i,j=f={type:d.type,c:d.name};this.setText(a);do{g=this.nextToken(),i=g.groups;if(g.type==="separator")continue;switch(g.c){case"str":g.v=i[1].replace(/""/,'"');break;case"num":g.v=Number(i[0].replace(/,/,""));break;case"cell":i[1]?(g.format="R1C1",i[5]&&(g.colInc=parseInt(i[5],10)),i[8]&&(g.rowInc=parseInt(i[8],10))):i[10]&&(g.format="A1",g.fixedCol=i[12]?!0:!1,g.col=b.getColumnIndex(i[11]),g.fixedRow=i[15]?!0:!1,g.row=parseInt(i[16],10));break;default:g.n=i[0]}g.prevToken=j,j.nextToken=g,j=g,delete g.groups}while(g.t<h);return g={type:e.type,c:e.name,prevToken:j},j.nextToken=g,{firstToken:f,lastToken:g}},parse:function(a){var b=this.tokenClasses,c,d,e,f,g;c=this.tokenize(a),f=g=d=c.firstToken,e=c.lastToken;a:while(f=f.nextToken){if(f.type==="operand")continue;f.c==="[+-]"&&f.prevToken.type!=="operand"&&(f.type="pre",f.c="unop");while(b[g.c].precedence>=b[f.c].precedence&&f.type!=="left"&&f.type!=="pre"){c=this.reduce(g,f),f=c.token,g=c.prevToken;if(!f||!g)break a}g=f}return d.r!==e&&this.throwException("Parse exception",null,null),d.a},throwException:function(a,b,c){throw{text:this.text,message:a,operator:{from:b.f,to:b.t},operand:{from:c.f,to:c.t}}},reduce:function(a,b){var c=a.type,d,e,f,g,h;if(c==="left"){f=a.nextToken;if((h=a.prevToken)&&h.c==="name"){a.c="func",a.n=h.n.toUpperCase(),a.f=h.f;if(a.prevToken=h.prevToken)h.prevToken.nextToken=a;del(h,"nextToken","prevToken","type"),g=a.a=[];if(f&&f.type==="operand"){while(f.c==="[,;]")g.unshift(f.r),f=f.l;f&&g.unshift(f),e=b}else e=f}else!f||f.type!=="operand"?this.throwException("Missing operand",a,operand):(a.a=f,e=f.nextToken,del(f,"nextToken","prevToken","type"));(!e||e.type!=="right")&&this.throwException("Missing right parenthesis",a,e),b=e.nextToken}else c!=="pre"&&((!(d=a.prevToken)||d.type!=="operand")&&this.throwException("Missing left operand",a,d),a.l=d,a.prevToken=d.prevToken,d.prevToken&&(d.prevToken.nextToken=a),del(d,"nextToken","prevToken","type","f","t")),c!=="post"&&(!(e=a.nextToken)||e.type!=="operand")&&this.throwException("Missing right operand",a,e);return c!=="post"&&(c==="left"?a.prevToken?a.t=e.t:a.r=e:a.r=e,a.nextToken=e.nextToken,e.nextToken&&(e.nextToken.prevToken=a),del(e,"nextToken","prevToken","type","f","t")),a.type="operand",{prevToken:a.prevToken,token:b}}},d}),define("js/whackcell/SpreadSheet.js",["require","js/utils.js","js/whackcell/DataGrid.js","js/whackcell/Range.js","js/whackcell/Movable.js","js/whackcell/Resizable.js","js/whackcell/KeyboardNavigable.js","js/whackcell/CellEditor.js","js/whackcell/CellNavigator.js","js/whackcell/CellValues.js","js/whackcell/FormulaSupport.js"],function(a){a("js/utils.js");var b=a("js/whackcell/DataGrid.js"),c=a("js/whackcell/Range.js"),d=a("js/whackcell/Movable.js"),e=a("js/whackcell/Resizable.js"),f=a("js/whackcell/KeyboardNavigable.js"),g=a("js/whackcell/CellEditor.js"),h=a("js/whackcell/CellNavigator.js"),i=a("js/whackcell/CellValues.js"),j=a("js/whackcell/FormulaSupport.js"),k;return(k=function(a){this.config=merge(a,{id:body,numDisplayRows:50,numDisplayCols:50,lastRow:50,lastCol:50}),this.render()}).prototype={render:function(){var a=this.config,c=el(a.id),k="wxl_navigator",l="wxl_editor",m="wxl_datagrid";chs(c,[crEl("DIV",{"class":"wxl_toolbar"},crEl("DIV")),crEl("DIV",{"class":"wxl_toolbar"},crEl("DIV",null,[crEl("INPUT",{id:k}),crEl("TEXTAREA",{id:l})])),crEl("DIV",{id:m,style:{top:"60px",left:"0px"}})]),m=new b(merge({div:m},this.config)),new f({dataGrid:m}),new d({dataGrid:m,ddsupport:!0}),new e({dataGrid:m,ddsupport:!0}),new i({dataGrid:m,formulaSupport:new j}),m.setCellEditor(new g({textarea:l})),new h({dataGrid:m,input:k})}},k}),require(["js/whackcell/SpreadSheet.js"],function(a){new a({numDisplayRows:10,numDisplayCols:10,lastRow:20,lastCol:20})}),define("main",function(){})